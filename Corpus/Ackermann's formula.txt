Not to be confused with Ackermann function. This article may be too technical for most readers to understand. Please help improve it to make it understandable to non-experts, without removing the technical details. (July 2017) (Learn how and when to remove this template message) Ackermann's formula is a control system design method for solving the pole allocation problem. One of the primary problems in control system design is the creation of controllers that will alter the dynamics of a system and alter the poles to a more suitable, and sometimes more stable, state. Such a problem can be tackled by many different methods; one such solution is the addition of a feedback loop in such a way that a gain is added to the input with which one can change the poles of the original system. If the system is controllable, an efficient method for pole placement is Ackermann's formula, which allows one to choose arbitrary poles within the system. [1][2] Contents 1 State feedback system 2 Ackermann's formula 2.1 Proof 3 Example 4 References State feedback system[edit] Consider a linear time invariant system[3] with a state-space representation x ˙ ( t ) = A x ( t ) + B u ( t ) {\displaystyle {\dot {x}}(t)=Ax(t)+Bu(t)} y ( t ) = C x ( t ) {\displaystyle y(t)=Cx(t)} where x ( t ) {\displaystyle x(t)} is the state vector, u ( t ) {\displaystyle u(t)} is the input vector, and A , B , C {\displaystyle A,B,C} are matrices of compatible dimensions that represent the dynamics of our system. An input-output description of this system is given by the transfer function C ( s I − A ) − 1 B = C Adj ⁡ ( s I − A ) det ( s I − A ) B . {\displaystyle C(sI-A)^{-1}B=C\ {\frac {\operatorname {Adj} (sI-A)}{\det(sI-A)}}\ B.} Since ( s I − A ) − 1 = Adj ⁡ ( s I − A ) det ( s I − A ) {\displaystyle (sI-A)^{-1}={\frac {\operatorname {Adj} (sI-A)}{\det(sI-A)}}} , the denominator of the system is given by the characteristic polynomial of A {\displaystyle A} . Thus, the poles of the system are the eigenvalues of A {\displaystyle A} . If the system is unstable, or has a slow response or any other characteristic that does not specify the design criteria, it could be advantageous to make changes to it. The realization given by { A , B , C } {\displaystyle \{A,B,C\}} , however, represents the dynamics of the system, and sometimes cannot be altered. Thus, one approach to this problem might be to create a feedback loop with a gain K {\displaystyle K} that will feed the state variable into the input. If the system is controllable, there is always an input u ( t ) {\displaystyle u(t)} such that any state x 0 {\displaystyle x_{0}} can be transferred to any other state x ( t ) {\displaystyle x(t)} . With that in mind, a feedback loop can be added to the system with the control input u ( t ) = r ( t ) − K x ( t ) {\displaystyle u(t)=r(t)-Kx(t)} , such that the new dynamics of the system will be x ˙ ( t ) = A x ( t ) + B [ r ( t ) − K x ( t ) ] = [ A − B K ] x ( t ) + B r ( t ) {\displaystyle {\dot {x}}(t)=Ax(t)+B[r(t)-Kx(t)]=[A-BK]x(t)+Br(t)} y ( t ) = C x ( t ) . {\displaystyle y(t)=Cx(t).} In this new realization, the poles will be dependent on the characteristic polynomial Δ n e w {\displaystyle \Delta _{new}} of A − B K {\displaystyle A-BK} , that is Δ new ( s ) = det ( s I − ( A − B K ) ) . {\displaystyle \Delta _{\text{new}}(s)=\det(sI-(A-BK)).} Ackermann's formula[edit] Computing the characteristic polynomial and choosing a suitable feedback matrix can be a challenging task, especially in larger systems. One way to make computations easier is through Ackermann's formula. For simplicity's sake, consider a single input vector with no reference parameter r {\displaystyle r} , such as u ( t ) = − k T x ( t ) {\displaystyle u(t)=-k^{T}x(t)} x ˙ ( t ) = A x ( t ) − B k T x ( t ) , {\displaystyle {\dot {x}}(t)=Ax(t)-Bk^{T}x(t),} where k T {\displaystyle k^{T}} is a feedback vector of compatible dimensions. Given that the system is still controllable, Ackermann's method states that the design process can be simplified by the following equation: k T = [ 0 0 ⋯ 0 1 ] C − 1 Δ new ( A ) , {\displaystyle k^{T}=\left[0\ 0\ \cdots \ 0\ 1\right]{\mathcal {C}}^{-1}\Delta _{\text{new}}(A),} in which Δ new ( A ) {\displaystyle \Delta _{\text{new}}(A)} is the desired characteristic polynomial evaluated at matrix A {\displaystyle A} . Proof[edit] [4] Assume that the system is controllable. Defining A C L := ( A − B k T ) {\displaystyle A_{CL}:=(A-Bk^{T})} gives Δ ( A C L ) = ( A C L ) n + ∑ k = 0 n − 1 α k A C L k − 1 {\displaystyle \Delta (A_{CL})=(A_{CL})^{n}+\sum _{k=0}^{n-1}\alpha _{k}A_{CL}^{k-1}} Calculating the powers of A C L {\displaystyle A_{CL}} results in ( A C L ) 0 = ( A − B k T ) 0 = I {\displaystyle (A_{CL})^{0}=(A-Bk^{T})^{0}=I} ( A C L ) 1 = ( A − B k T ) 1 = A − B k T {\displaystyle (A_{CL})^{1}=(A-Bk^{T})^{1}=A-Bk^{T}} ( A C L ) 2 = ( A − B k T ) 2 = A 2 − A B k T − B k T A + ( B k T ) 2 = A 2 − A B k T − ( B k T ) [ A − B k T ] = A 2 − A B k T − B k T A C L {\displaystyle (A_{CL})^{2}=(A-Bk^{T})^{2}=A^{2}-ABk^{T}-Bk^{T}A+(Bk^{T})^{2}=A^{2}-ABk^{T}-(Bk^{T})[A-Bk^{T}]=A^{2}-ABk^{T}-Bk^{T}A_{CL}} ( A C L ) n = ( A − B k T ) n = A n − A n − 1 B k T − A n − 2 B k T A C L − ⋯ − B k T A C L n − 1 {\displaystyle (A_{CL})^{n}=(A-Bk^{T})^{n}=A^{n}-A^{n-1}Bk^{T}-A^{n-2}Bk^{T}A_{CL}-\cdots -Bk^{T}A_{CL}^{n-1}} Replacing the previous equations into Δ ( A C L ) {\displaystyle \Delta (A_{CL})} yields Δ ( A C L ) = ( A n − A n − 1 B k T − A n − 2 B k T A C L − ⋯ − B k T A C L n − 1 ) + ⋯ + α 2 ( A 2 − A B k T − B k T A C L ) + α 1 ( A − B k T ) + α 0 I {\displaystyle \Delta (A_{CL})=(A^{n}-A^{n-1}Bk^{T}-A^{n-2}Bk^{T}A_{CL}-\cdots -Bk^{T}A_{CL}^{n-1})+\cdots +\alpha _{2}(A^{2}-ABk^{T}-Bk^{T}A_{CL})+\alpha _{1}(A-Bk^{T})+\alpha _{0}I} Δ ( A C L ) = ( A n + α n − 1 A n − 1 + ⋯ + α 2 A 2 + α 1 A + α 0 I ) − ( A n − 1 B k T + A n − 2 B k T A C L + ⋯ + B k T A C L n − 1 ) + ⋯ + α 2 ( A B k T + B k T A C L ) + α 1 ( B k T ) {\displaystyle \Delta (A_{CL})=(A^{n}+\alpha _{n-1}A^{n-1}+\cdots +\alpha _{2}A^{2}+\alpha _{1}A+\alpha _{0}I)-(A^{n-1}Bk^{T}+A^{n-2}Bk^{T}A_{CL}+\cdots +Bk^{T}A_{CL}^{n-1})+\cdots +\alpha _{2}(ABk^{T}+Bk^{T}A_{CL})+\alpha _{1}(Bk^{T})} Noting that ( A n + α n − 1 A n − 1 + ⋯ + α 2 A 2 + α 1 A + α 0 I ) = Δ ( A ) {\displaystyle (A^{n}+\alpha _{n-1}A^{n-1}+\cdots +\alpha _{2}A^{2}+\alpha _{1}A+\alpha _{0}I)=\Delta (A)} . Δ ( A C L ) = Δ ( A ) − ( A n − 1 B k T + A n − 2 B k T A C L + ⋯ + B k T A C L n − 1 ) + ⋯ + α 2 ( A B k T + B k T A C L ) + α 1 ( A + B k T ) {\displaystyle \Delta (A_{CL})=\Delta (A)-(A^{n-1}Bk^{T}+A^{n-2}Bk^{T}A_{CL}+\cdots +Bk^{T}A_{CL}^{n-1})+\cdots +\alpha _{2}(ABk^{T}+Bk^{T}A_{CL})+\alpha _{1}(A+Bk^{T})} Rewriting the above equation as a matrix product and omitting the terms that k T {\displaystyle k^{T}} does not appear isolated gives Δ ( A C L ) = Δ ( A ) − [ B A B ⋯ A n − 1 B ] [ ⋮ k T ] {\displaystyle \Delta (A_{CL})=\Delta (A)-\left[B\ \ AB\ \ \cdots \ \ A^{n-1}B\right]\left[{\begin{array}{c}\vdots \\k^{T}\end{array}}\right]} From the Cayley–Hamilton theorem, Δ ( A C L ) = 0 {\displaystyle \Delta \left(A_{CL}\right)=0} , thus [ B A B ⋯ A n − 1 B ] [ ⋮ k T ] = Δ ( A ) {\displaystyle \left[B\ \ AB\ \ \cdots \ \ A^{n-1}B\right]\left[{\begin{array}{c}\vdots \\k^{T}\end{array}}\right]=\Delta (A)} Note that C = [ B A B ⋯ A n − 1 B ] {\displaystyle {\mathcal {C}}=\left[B\ \ AB\ \ \cdots \ \ A^{n-1}B\right]} is the controllability matrix of the system. Since the system is controllable, C {\displaystyle {\mathcal {C}}} is invertible. Thus, [ ⋮ k T ] = C − 1 Δ ( A ) {\displaystyle \left[{\begin{array}{c}\vdots \\k^{T}\end{array}}\right]={\mathcal {C}}^{-1}\Delta (A)} To find k T {\displaystyle k^{T}} , both sides can be multiplied by the vector [ 0 0 0 ⋯ 1 ] {\displaystyle \left[{\begin{array}{ccccc}0&0&0&\cdots &1\end{array}}\right]} . This yields [ 0 0 0 ⋯ 1 ] [ ⋮ k T ] = [ 0 0 0 ⋯ 1 ] C − 1 Δ ( A ) {\displaystyle \left[{\begin{array}{ccccc}0&0&0&\cdots &1\end{array}}\right]\left[{\begin{array}{c}\vdots \\k^{T}\end{array}}\right]=\left[{\begin{array}{ccccc}0&0&0&\cdots &1\end{array}}\right]{\mathcal {C}}^{-1}\Delta (A)} Thus, k T = [ 0 0 0 ⋯ 1 ] C − 1 Δ ( A ) {\displaystyle k^{T}=\left[{\begin{array}{ccccc}0&0&0&\cdots &1\end{array}}\right]{\mathcal {C}}^{-1}\Delta (A)} Example[edit] Consider[5] x ˙ = [ 1 1 1 2 ] x + [ 1 0 ] u {\displaystyle {\dot {x}}=\left[{\begin{array}{cc}1&1\\1&2\end{array}}\right]x+\left[{\begin{array}{c}1\\0\end{array}}\right]u} We know from the characteristic polynomial of A {\displaystyle A} that the system is unstable since d e t ( s I − A ) = ( s − 1 ) ( s − 2 ) − 1 = s 2 − 3 s + 1 {\displaystyle det(sI-A)=(s-1)(s-2)-1=s^{2}-3s+1} , the matrix A {\displaystyle A} will only have positive eigenvalues. Thus, to stabilize the system we shall put a feedback gain K = [ k 1 k 2 ] . {\displaystyle K=\left[{\begin{array}{cc}k_{1}&k_{2}\end{array}}\right].} From Ackermann's formula, we can find a matrix k {\displaystyle k} that will change the system so that its characteristic equation will be equal to a desired polynomial. Suppose we want Δ desired ( s ) = s 2 + 11 s + 30 {\displaystyle \Delta _{\text{desired}}(s)=s^{2}+11s+30} . Thus, Δ desired ( A ) = A 2 + 11 A + 30 I {\displaystyle \Delta _{\text{desired}}(A)=A^{2}+11A+30I} and computing the controllability matrix yields C = [ B A B ] = [ 1 1 0 1 ] {\displaystyle {\mathcal {C}}=\left[{\begin{array}{cc}B&AB\end{array}}\right]=\left[{\begin{array}{cc}1&1\\0&1\end{array}}\right]} and C − 1 = [ 1 − 1 0 1 ] . {\displaystyle {\mathcal {C}}^{-1}=\left[{\begin{array}{cc}1&-1\\0&1\end{array}}\right].} Also, we have that A 2 = [ 2 3 3 5 ] . {\displaystyle A^{2}=\left[{\begin{array}{cc}2&3\\3&5\end{array}}\right].} Finally, from Ackermann's formula k T = [ 0 1 ] [ 1 − 1 0 1 ] [ [ 2 3 3 5 ] + 11 [ 1 1 1 2 ] + 30 I ] {\displaystyle k^{T}=\left[{\begin{array}{cc}0&1\end{array}}\right]\left[{\begin{array}{cc}1&-1\\0&1\end{array}}\right]\left[\left[{\begin{array}{cc}2&3\\3&5\end{array}}\right]+11\left[{\begin{array}{cc}1&1\\1&2\end{array}}\right]+30I\right]} k T = [ 0 1 ] [ 1 − 1 0 1 ] [ 43 14 14 57 ] = [ 0 1 ] [ 29 − 43 14 57 ] {\displaystyle k^{T}=\left[{\begin{array}{cc}0&1\end{array}}\right]\left[{\begin{array}{cc}1&-1\\0&1\end{array}}\right]\left[{\begin{array}{cc}43&14\\14&57\end{array}}\right]=\left[{\begin{array}{cc}0&1\end{array}}\right]\left[{\begin{array}{cc}29&-43\\14&57\end{array}}\right]} k T = [ 14 57 ] {\displaystyle k^{T}=\left[{\begin{array}{cc}14&57\end{array}}\right]} References[edit] ^ Modern Control System Theory and Design, 2nd Edition by Stanley M. Shinners ^ "State variable feedback" (PDF). Uta.edu. Retrieved 2017-07-06..mw-parser-output cite.citation{font-style:inherit}.mw-parser-output .citation q{quotes:"\"""\"""'""'"}.mw-parser-output .citation .cs1-lock-free a{background:url("//upload.wikimedia.org/wikipedia/commons/thumb/6/65/Lock-green.svg/9px-Lock-green.svg.png")no-repeat;background-position:right .1em center}.mw-parser-output .citation .cs1-lock-limited a,.mw-parser-output .citation .cs1-lock-registration a{background:url("//upload.wikimedia.org/wikipedia/commons/thumb/d/d6/Lock-gray-alt-2.svg/9px-Lock-gray-alt-2.svg.png")no-repeat;background-position:right .1em center}.mw-parser-output .citation .cs1-lock-subscription a{background:url("//upload.wikimedia.org/wikipedia/commons/thumb/a/aa/Lock-red-alt-2.svg/9px-Lock-red-alt-2.svg.png")no-repeat;background-position:right .1em center}.mw-parser-output .cs1-subscription,.mw-parser-output .cs1-registration{color:#555}.mw-parser-output .cs1-subscription span,.mw-parser-output .cs1-registration span{border-bottom:1px dotted;cursor:help}.mw-parser-output .cs1-ws-icon a{background:url("//upload.wikimedia.org/wikipedia/commons/thumb/4/4c/Wikisource-logo.svg/12px-Wikisource-logo.svg.png")no-repeat;background-position:right .1em center}.mw-parser-output code.cs1-code{color:inherit;background:inherit;border:inherit;padding:inherit}.mw-parser-output .cs1-hidden-error{display:none;font-size:100%}.mw-parser-output .cs1-visible-error{font-size:100%}.mw-parser-output .cs1-maint{display:none;color:#33aa33;margin-left:0.3em}.mw-parser-output .cs1-subscription,.mw-parser-output .cs1-registration,.mw-parser-output .cs1-format{font-size:95%}.mw-parser-output .cs1-kern-left,.mw-parser-output .cs1-kern-wl-left{padding-left:0.2em}.mw-parser-output .cs1-kern-right,.mw-parser-output .cs1-kern-wl-right{padding-right:0.2em} ^ "Control Systems/State Feedback - Wikibooks, open books for an open world". en.wikibooks.org. Retrieved 6 July 2017. ^ "Pole Placement Control" (PDF). Eolss.net. Retrieved 2017-07-06. ^ "Topic #13 : 16.31 Feedback Control" (PDF). Web.mit.edu. Retrieved 2017-07-06.